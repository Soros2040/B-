# 数据分析负责人操作指南

## 写给陶婉玉的话

你好！作为数据分析负责人，你将负责所有数据分析任务。本指南将帮助你从零开始完成所有分析工作。

**重要提示**：
1. 本指南中的每个步骤都可以直接复制到TRAE中执行
2. 遇到任何问题，都可以直接问TRAE
3. 不需要担心没有经验，TRAE会一步步指导你

---

## 第一部分：环境搭建

### 1.1 Python环境配置

**已有环境**：
- 环境名称：benjamin
- Python版本：3.12.12
- 完整路径：E:\anaconda\envs\benjamin\python.exe

**激活环境**：
```bash
conda activate benjamin
```

### 1.2 核心依赖库

| 类别 | 库名 | 版本要求 | 用途 |
|------|------|----------|------|
| **数据处理** | pandas | >=2.0 | 数据读写、处理 |
| | numpy | >=2.0 | 数值计算 |
| | scipy | >=1.10 | 统计计算 |
| **统计分析** | statsmodels | >=0.14 | 统计建模 |
| | scikit-learn | >=1.3 | 机器学习 |
| | factor_analyzer | >=0.5 | 因子分析 |
| **SEM建模** | semopy | >=2.3 | 结构方程模型 |
| **文本分析** | transformers | >=4.0 | BERT模型 |
| | sentence-transformers | >=2.0 | 文本嵌入 |
| | bertopic | >=0.16 | 主题建模 |
| | jieba | >=0.12 | 中文分词 |
| | snownlp | >=0.12 | 中文情感分析 |
| **可视化** | matplotlib | >=3.8 | 绑图 |
| | seaborn | >=0.13 | 统计绘图 |
| | plotly | >=5.0 | 交互式图表 |
| **多准则决策** | pyDecision | >=4.9 | AHP、TOPSIS、DEMATEL |
| **网络分析** | networkx | >=3.0 | 社会网络分析 |
| **贝叶斯分析** | bnlearn | >=0.12 | 贝叶斯网络 |
| **其他** | openpyxl | >=3.1 | Excel读写 |
| | torch | >=2.0 | 深度学习框架 |

### 1.3 安装命令

**复制以下内容到TRAE执行**：

```
请帮我检查并安装以下Python库（如果未安装）：
pandas, numpy, scipy, statsmodels, scikit-learn, factor_analyzer,
semopy, transformers, sentence-transformers, bertopic, jieba, snownlp,
matplotlib, seaborn, plotly, networkx, openpyxl, torch

使用清华镜像源加速安装：
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple 库名
```

### 1.4 安装时间预估

| 库名 | 安装时间 | 说明 |
|------|----------|------|
| pandas, numpy | 1-2分钟 | 基础库 |
| matplotlib, seaborn | 1-2分钟 | 绑图库 |
| scipy, scikit-learn | 2-3分钟 | 统计/机器学习 |
| bertopic | 5-10分钟 | 较大，需下载模型 |
| sentence-transformers | 10-15分钟 | 较大，需下载模型 |
| transformers | 5-10分钟 | 预训练模型 |
| jieba, snownlp | 1分钟 | 中文处理 |
| networkx | 1分钟 | 网络分析 |
| semopy | 1-2分钟 | SEM建模 |
| pyDecision | 2-3分钟 | 多准则决策 |
| **总计** | **30-45分钟** | - |

---

## 第二部分：数据预处理

### 2.1 问卷数据预处理

**当问卷回收后，复制以下内容到TRAE**：

```
我有一份问卷数据文件：E:\B正大杯\dataexample\survey_data_simulated.csv

请帮我完成以下数据预处理任务：

1. 读取CSV文件
2. 检查数据基本信息：
   - 样本量
   - 变量数量
   - 缺失值情况
   - 数据类型
3. 数据清洗：
   - 删除填写时间过短的样本（<60秒）
   - 删除所有题项答案相同的样本
   - 处理缺失值（删除缺失率>30%的样本）
4. 数据转换：
   - 将Likert量表数据转换为数值类型
   - 将分类变量转换为类别类型
5. 输出清洗后的数据到：E:\B正大杯\dataexample\survey_data_cleaned.csv

请逐步执行，并在每一步告诉我结果。
```

### 2.2 文本数据预处理

**当有痛点描述文本后，复制以下内容到TRAE**：

```
我有问卷数据中的开放题字段：Q19_pain_points 和 Q20_suggestions

请帮我完成以下文本预处理任务：

1. 从问卷数据中提取开放题文本
2. 中文分词（使用jieba库）：
   - 加载停用词表
   - 进行分词
   - 去除停用词
3. 文本清洗：
   - 去除标点符号
   - 去除数字
   - 去除单字词
4. 输出预处理后的文本到：E:\B正大杯\dataexample\text_preprocessed.csv

请逐步执行，并在每一步告诉我结果。
```

---

## 第三部分：RQ1痛点识别分析

### 3.1 BERT嵌入 + KMeans主题建模

**复制以下内容到TRAE**：

```
我有预处理后的痛点描述文本数据

请帮我进行BERT嵌入 + KMeans主题建模分析：

1. 环境准备：
   - 导入sentence_transformers库
   - 导入sklearn.cluster.KMeans
   
2. 加载数据：
   - 读取预处理后的文本文件
   
3. BERT嵌入生成：
   - 使用中文预训练模型：paraphrase-multilingual-MiniLM-L12-v2
   - 生成384维文本嵌入向量
   
4. KMeans聚类：
   - 使用轮廓系数确定最优聚类数K（测试K=5到15）
   - 进行KMeans聚类
   - 输出聚类结果
   
5. 主题解释：
   - 使用jieba提取各主题关键词
   - 基于关键词对主题进行命名
   
6. 结果输出：
   - 输出主题概览（主题编号、文档数量、关键词）
   - 生成主题分布柱状图
   - 生成主题-词汇分布热力图
   - 保存结果到：E:\B正大杯\results\rq1_topic_modeling.xlsx
   
请逐步执行，并在每一步告诉我结果。如果遇到错误，请告诉我如何解决。
```

### 3.2 BERT情感分析

**复制以下内容到TRAE**：

```
我有预处理后的痛点描述文本数据

请帮我进行BERT情感分析：

1. 环境准备：
   - 导入transformers库
   - 加载情感分析模型：lxyuan/distilbert-base-multilingual-cased-sentiments-student
   
2. 加载数据：
   - 读取预处理后的文本文件
   
3. 情感分析：
   - 对每条文本进行情感分类（positive/negative/neutral）
   - 计算情感得分
   
4. 结果输出：
   - 输出情感分布统计
   - 生成情感分布饼图
   - 分析不同主题的情感分布
   - 保存结果到：E:\B正大杯\results\rq1_sentiment_analysis.xlsx
   
请逐步执行，并在每一步告诉我结果。
```

---

## 第四部分：RQ2因果分析

### 4.1 DEMATEL分析

**复制以下内容到TRAE**：

```
我有问卷数据中的痛点影响因素评分数据

请帮我进行DEMATEL分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   导入matplotlib库
   
2. 数据准备：
   - 从问卷数据提取Q7_1_2到Q7_6_5的二元矩阵数据
   - 构建6×6直接影响矩阵Z（6个痛点因素）
   
3. DEMATEL计算步骤：
   步骤1：构建直接影响矩阵Z
   步骤2：计算规范化矩阵X = Z / max(sum(Z, axis=1))
   步骤3：计算综合影响矩阵T = X × (I - X)^(-1)
   步骤4：计算影响度R = sum(T, axis=1)（行和）
   步骤5：计算被影响度C = sum(T, axis=0)（列和）
   步骤6：计算中心度D = R + C
   步骤7：计算原因度P = R - C
   
4. 结果输出：
   - 输出各因素的中心度和原因度
   - 生成因果四象限图（横轴为中心度，纵轴为原因度）
   - 识别原因因素（P>0）和结果因素（P<0）
   - 保存结果到：E:\B正大杯\results\rq2_dematel.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 4.2 ISM分析

**复制以下内容到TRAE**：

```
我有DEMATEL的综合影响矩阵

请帮我进行ISM分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 加载数据：
   - 读取综合影响矩阵T
   
3. ISM计算步骤：
   步骤1：确定阈值θ（建议使用矩阵均值或中位数）
   步骤2：构建可达矩阵M（T>=θ的位置为1，否则为0）
   步骤3：计算可达集R(Si)（第i行值为1的列索引）
   步骤4：计算先行集A(Si)（第i列值为1的行索引）
   步骤5：层次划分：
          - 第一层：R(Si) ∩ A(Si) == R(Si) 的因素
          - 移除第一层因素，继续划分下一层
          - 重复直到所有因素划分完毕
   
4. 结果输出：
   - 输出层次划分结果
   - 生成递阶层次结构图
   - 保存结果到：E:\B正大杯\results\rq2_ism.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 4.3 SEM结构方程模型

**复制以下内容到TRAE**：

```
我有问卷数据中的量表数据：Q9_TTF、Q10_SI、Q11_PV、Q12_RD、Q13_RV

请帮我进行SEM结构方程模型分析：

1. 环境准备：
   - 导入semopy库
   - 导入pandas库
   - 导入numpy库
   
2. 加载数据：
   - 读取问卷数据
   - 提取量表变量
   
3. 定义SEM模型：
   # 测量模型
   TTF =~ Q9_TTF1 + Q9_TTF2 + Q9_TTF3 + Q9_TTF4
   SI =~ Q10_SI1 + Q10_SI2 + Q10_SI3 + Q10_SI4
   PV =~ Q11_PV1 + Q11_PV2 + Q11_PV3 + Q11_PV4
   RD =~ Q12_RD1 + Q12_RD2 + Q12_RD3 + Q12_RD4 + Q12_RD5 + Q12_RD6 + Q12_RD7 + Q12_RD8
   
   # 结构模型
   PV ~ TTF + SI
   BI ~ PV + RD
   
   # 调节效应
   PV ~ TTF:SI
   
4. 模型估计：
   - 使用semopy.Model()创建模型
   - 调用fit()方法估计参数
   
5. 模型检验：
   - 计算模型拟合指标（CFI、TLI、RMSEA、SRMR）
   - 检验路径系数显著性
   
6. 结果输出：
   - 输出路径系数表
   - 输出模型拟合报告
   - 生成路径图
   - 保存结果到：E:\B正大杯\results\rq2_sem.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。如果样本量不足，请告诉我如何改用PLS-SEM。
```

---

## 第五部分：RQ3决策支持分析

### 5.1 模糊AHP分析

**复制以下内容到TRAE**：

```
我有问卷数据中的技术方案两两比较数据：Q15_X_A、Q15_X_A_val等

请帮我进行模糊AHP分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 数据准备：
   - 从问卷数据提取两两比较数据
   - 构建三角模糊数判断矩阵（l, m, u）
   
3. 模糊AHP计算步骤：
   步骤1：构建模糊判断矩阵
   步骤2：计算每行的模糊几何平均值
   步骤3：计算模糊权重
   步骤4：去模糊化（使用重心法：w = (l+m+u)/3）
   步骤5：归一化权重
   步骤6：一致性检验（使用Crisp矩阵计算CR）
   
4. 结果输出：
   - 输出各技术方案的权重
   - 输出权重排序
   - 生成权重柱状图
   - 保存结果到：E:\B正大杯\results\rq3_fuzzy_ahp.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 5.2 TOPSIS分析

**复制以下内容到TRAE**：

```
我有问卷数据中的技术方案评估数据：Q14_X_low、Q14_X_mid、Q14_X_high
我有模糊AHP计算的权重数据

请帮我进行TOPSIS分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 数据准备：
   - 从问卷数据提取技术成熟度评估数据
   - 使用三角模糊数的中间值作为评估值
   - 读取权重向量
   
3. TOPSIS计算步骤：
   步骤1：构建决策矩阵D
   步骤2：规范化决策矩阵（向量归一化）
   步骤3：加权规范化矩阵V = W × D_normalized
   步骤4：确定正理想解A+（各列最大值）和负理想解A-（各列最小值）
   步骤5：计算各方案到正理想解的距离D+
   步骤6：计算各方案到负理想解的距离D-
   步骤7：计算相对贴近度C = D- / (D+ + D-)
   
4. 结果输出：
   - 输出各方案的相对贴近度
   - 输出方案排序
   - 生成排序柱状图和雷达图
   - 保存结果到：E:\B正大杯\results\rq3_topsis.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 5.3 敏感性分析

**复制以下内容到TRAE**：

```
我有TOPSIS结果和原始评估数据

请帮我进行敏感性分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   - 导入matplotlib库
   
2. 敏感性分析方法：
   方法1：权重敏感性分析
   - 将每个权重增加/减少10%、20%、30%
   - 观察方案排序的变化
   - 绑制敏感性曲线
   
   方法2：蒙特卡洛模拟
   - 在权重上添加随机扰动（±10%）
   - 重复TOPSIS计算1000次
   - 统计各方案排序的分布
   
3. 结果输出：
   - 输出敏感性分析报告
   - 生成敏感性曲线图
   - 保存结果到：E:\B正大杯\results\rq3_sensitivity.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

---

## 第六部分：RQ4趋势预测分析

### 6.1 技术路线图绘制

**复制以下内容到TRAE**：

```
我有技术发展时间线数据：E:\B正大杯\dataexample\tech_timeline.csv

请帮我绘制技术路线图：

1. 环境准备：
   - 导入matplotlib库
   - 导入pandas库
   
2. 加载数据：
   - 读取技术时间线数据
   
3. 数据处理：
   - 按技术分类分组
   - 按时间排序
   
4. 绘制技术路线图：
   - 横轴：时间（2015-2025）
   - 纵轴：技术分类
   - 标注关键事件节点
   - 区分事件类型（产品发布、技术突破、企业成立等）
   
5. 结果输出：
   - 生成技术路线图
   - 保存图片到：E:\B正大杯\results\rq4_tech_roadmap.png
   
请逐步执行，并在每一步告诉我结果。
```

### 6.2 政策时间线分析

**复制以下内容到TRAE**：

```
我有政策发展时间线数据：E:\B正大杯\dataexample\policy_timeline.csv

请帮我分析政策演进趋势：

1. 环境准备：
   - 导入pandas库
   - 导入matplotlib库
   
2. 加载数据：
   - 读取政策时间线数据
   
3. 数据分析：
   - 按政策阶段分组统计
   - 按政策类型分组统计
   - 分析政策与技术的关联
   
4. 结果输出：
   - 生成政策演进时间线图
   - 生成政策类型分布图
   - 保存结果到：E:\B正大杯\results\rq4_policy_timeline.png
   
请逐步执行，并在每一步告诉我结果。
```

### 6.3 情景分析

**复制以下内容到TRAE**：

```
我有技术成熟度评估数据和专家预期数据

请帮我进行情景分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   - 导入matplotlib库
   
2. 情景设定：
   - 乐观情景：技术快速成熟、政策大力支持
   - 基准情景：按当前趋势发展
   - 悲观情景：技术发展缓慢、政策收紧
   
3. 情景分析：
   - 基于三角模糊数的乐观/基准/悲观值
   - 预测各情景下的技术采纳率
   - 预测市场规模变化
   
4. 结果输出：
   - 生成情景分析对比图
   - 生成预测曲线图（含置信区间）
   - 保存结果到：E:\B正大杯\results\rq4_scenario.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

---

## 第七部分：常见问题与解决方案

### 7.1 安装问题

| 问题 | 解决方案 |
|------|----------|
| pip安装超时 | 使用国内镜像：`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple 库名` |
| bertopic安装失败 | 先安装依赖：`pip install hdbscan umap-learn` |
| sentence-transformers下载模型慢 | 设置镜像：`set HF_ENDPOINT=https://hf-mirror.com` |
| torch安装慢 | 使用conda安装：`conda install pytorch` |

### 7.2 数据问题

| 问题 | 解决方案 |
|------|----------|
| CSV文件读取乱码 | 使用`encoding='utf-8'`或`encoding='gbk'` |
| Excel文件读取失败 | 确保文件未被其他程序打开，或另存为xlsx格式 |
| 缺失值过多 | 删除缺失率>30%的样本或变量 |
| 数据类型错误 | 使用`pd.to_numeric()`转换数值类型 |

### 7.3 分析问题

| 问题 | 解决方案 |
|------|----------|
| 样本量不足（SEM） | 改用PLS-SEM，或简化模型减少参数 |
| 模型不收敛 | 检查数据质量，尝试不同的初始值 |
| 结果不合理 | 检查数据输入是否正确，检查方法假设是否满足 |
| 内存不足 | 分批处理数据，或使用更小的模型 |

---

## 第八部分：与TRAE交互的提示词模板

### 模板1：遇到错误时

```
我在执行以下代码时遇到了错误：

[粘贴你的代码]

错误信息是：
[粘贴错误信息]

请告诉我：
1. 错误的原因是什么？
2. 如何修复这个错误？
3. 修复后的完整代码是什么？
```

### 模板2：需要解释结果时

```
我得到了以下分析结果：

[粘贴你的结果]

请帮我解释：
1. 这个结果说明了什么？
2. 如何在报告中描述这个结果？
3. 这个结果有什么局限性？
```

### 模板3：需要生成报告内容时

```
我有以下分析结果：

[粘贴你的结果]

请帮我撰写报告中的分析结果部分：
1. 使用学术语言
2. 包含数据表格和图表描述
3. 包含结果解释和讨论
4. 字数约500-800字
```

### 模板4：需要生成可视化时

```
我有以下数据：

[粘贴你的数据]

请帮我生成可视化图表：
1. 图表类型：[柱状图/折线图/热力图/散点图等]
2. 图表标题：[标题]
3. X轴标签：[标签]
4. Y轴标签：[标签]
5. 配色方案：[方案]
6. 保存路径：E:\B正大杯\results\[文件名].png
```

---

## 第九部分：工作流程图

```
Day 1-2: 环境搭建与预热
├── Day 1: 环境搭建、政策数据分析
└── Day 2: 技术时间线分析、案例分析

Day 3: 数据交接与描述性统计
├── 数据交接会议
├── 描述性统计分析
└── 文本数据预处理

Day 4: RQ1痛点识别
├── BERT嵌入生成
├── KMeans主题建模
├── BERT情感分析
└── 痛点清单整理

Day 5: RQ2因果分析
├── DEMATEL计算
├── ISM分层
├── SEM模型构建
└── 因果路径验证

Day 6: RQ3-RQ4决策与趋势
├── 模糊AHP权重计算
├── TOPSIS排序
├── 敏感性分析
├── 技术路线图
└── 情景分析

Day 7: 图表优化与确认
├── 图表美化
├── 数据结果确认
└── 最终报告对接

Day 8: 最终确认
└── 数据确认报告
```

---

## 第十部分：输出物清单

| 输出物 | 文件名 | 用途 | 交付时间 |
|--------|--------|------|----------|
| 清洗后问卷数据 | survey_data_cleaned.csv | 所有分析的数据基础 | Day 3 |
| RQ1主题建模结果 | rq1_topic_modeling.xlsx | RQ1痛点分类 | Day 4 |
| RQ1情感分析结果 | rq1_sentiment_analysis.xlsx | RQ1态度分析 | Day 4 |
| RQ2 DEMATEL结果 | rq2_dematel.xlsx | RQ2因果分析 | Day 5 |
| RQ2 ISM结果 | rq2_ism.xlsx | RQ2层次结构 | Day 5 |
| RQ2 SEM结果 | rq2_sem.xlsx | RQ2路径分析 | Day 5 |
| RQ3模糊AHP结果 | rq3_fuzzy_ahp.xlsx | RQ3权重计算 | Day 6 |
| RQ3 TOPSIS结果 | rq3_topsis.xlsx | RQ3方案排序 | Day 6 |
| RQ3敏感性分析结果 | rq3_sensitivity.xlsx | RQ3稳健性检验 | Day 6 |
| RQ4技术路线图 | rq4_tech_roadmap.png | RQ4趋势展示 | Day 6 |
| RQ4政策时间线 | rq4_policy_timeline.png | RQ4政策分析 | Day 6 |
| RQ4情景分析结果 | rq4_scenario.xlsx | RQ4预测分析 | Day 6 |

---

## 第十一部分：核心变量速查表

### SEM模型变量

| 潜变量 | 观测变量 | 问卷题号 |
|--------|----------|----------|
| **TTF（任务-技术匹配）** | 技术功能匹配、易于使用、可靠稳定、学习成本低 | Q9_TTF1-4 |
| **SI（社会影响）** | 领导支持、同事认可、行业趋势、政策引导 | Q10_SI1-4 |
| **PV（感知价值）** | 提升效率、降低成本、提升质量、增强竞争力 | Q11_PV1-4 |
| **RD（风险感知）** | 技术/安全/合规/成本等风险 | Q12_RD1-8 |

### DEMATEL因素

| 编号 | 因素名称 | 说明 |
|------|----------|------|
| F1 | 数据孤岛 | 系统间数据无法互通 |
| F2 | AI融合困难 | AI技术与RPA集成难度大 |
| F3 | 系统兼容性 | 与现有系统兼容问题 |
| F4 | 实施成本高 | 部署和维护成本高 |
| F5 | 合规风险 | 数据安全和合规要求 |
| F6 | 人才短缺 | 缺乏专业RPA人才 |

---

*文档版本：v2.0*
*创建日期：2026-02-16*
*更新日期：2026-02-21*
*适用对象：数据分析负责人（陶婉玉）*
*主要更新：同步最新依赖库版本、更新数据路径、优化提示词模板*
