# 数据分析负责人操作指南

## 写给陶婉玉的话

你好！作为数据分析负责人，你将负责所有数据分析任务和所有章节的可视化数据输出。本指南将帮助你从零开始完成所有分析工作。

**重要提示**：
1. 本指南中的每个步骤都可以直接复制到TRAE中执行
2. 遇到任何问题，都可以直接问TRAE
3. 不需要担心没有经验，TRAE会一步步指导你

**⚠️ 可视化工具要求**：
- **请使用 ECharts 作图**，生成HTML文件即可
- ECharts优点：交互式图表、美观、可直接嵌入报告、支持导出PNG
- 在TRAE中输入"用ECharts帮我画XXX图"即可生成代码

---

## 第一部分：你的核心职责

### 1.1 职责概述

| 阶段 | 任务 | 产出 |
|------|------|------|
| **Day 1-2** | 直接制作第二三章可视化图表 | 6张图表 |
| **Day 3-4** | 数据分析启动 + 调研框架优化 | 分析框架文档 |
| **Day 3-8** | 数据分析落实 + 所有章节可视化数据输出 | 图表数据、表格数据、分析结论 |

### 1.2 数据对接流程

```
【陶婉玉】数据分析输出
     │
     ├──▶ 图表数据（JSON/CSV） ──▶ 【绘图组】武翌雅 + 辅助组支援
     │
     ├──▶ 表格数据（Excel） ──▶ 【制表组】梁明睿
     │
     └──▶ 分析结论（Markdown） ──▶ 【文字组】张坦
```

---

## 第二部分：Day 1-2 可视化图表制作

### 2.1 第二章图表（Day 1）

| 图表名称 | 说明 | 数据来源 |
|----------|------|----------|
| 研究框架图 | 展示研究整体框架 | 研究框架文档 |
| 调查流程图 | 展示调查实施流程 | 调查设计文档 |
| 数据流程图 | 展示数据处理流程 | 数据处理文档 |

**复制以下内容到TRAE**：
```
请用ECharts帮我制作第二章的3张图表：
1. 研究框架图（展示RPA金融领域市场调研的整体研究框架）
2. 调查流程图（展示问卷设计、发放、回收、清洗的完整流程）
3. 数据流程图（展示数据采集、预处理、分析、输出的完整流程）

要求：
- 使用ECharts生成HTML文件
- 风格简洁专业
- 保存到：E:\B正大杯\results\chapter2\
```

### 2.2 第三章图表（Day 2）

| 图表名称 | 说明 | 数据来源 |
|----------|------|----------|
| 信度系数图 | 展示各量表Cronbach's α | 问卷数据 |
| 效度检验图 | 展示KMO和Bartlett检验结果 | 问卷数据 |
| 样本分布图 | 展示样本特征分布 | 问卷数据 |

**复制以下内容到TRAE**：
```
我有问卷数据文件：E:\B正大杯\dataexample\survey_data_simulated.csv

请用ECharts帮我制作第三章的3张图表：
1. 信度系数图（展示各量表的Cronbach's α系数）
2. 效度检验图（展示KMO值和Bartlett球形检验结果）
3. 样本分布图（展示样本的行业分布、部门分布、岗位分布）

要求：
- 先进行信效度分析
- 使用ECharts生成HTML文件
- 保存到：E:\B正大杯\results\chapter3\
```

---

## 第三部分：Day 3-8 数据分析与可视化数据输出

### 3.1 各章节数据分析任务

| 章节 | 数据分析任务 | 可视化数据输出 |
|------|--------------|----------------|
| 第一章 | 文献综述数据整理 | 研究框架数据、技术演进数据 |
| 第二章 | 调查设计数据整理 | 调查流程数据、数据流程数据 |
| 第三章 | 信效度分析、描述性统计 | 信度系数数据、效度检验数据、样本分布数据 |
| 第四章 | SEM结构方程模型 | 路径系数数据、模型拟合指标、假设检验数据 |
| 第五章 | 时间序列分析、三层递进分析 | 技术演进数据、政策演进数据、协同演进数据 |
| 第六章 | BERT文本分析、主题建模、情感分析 | 痛点主题数据、需求主题数据、情感分析数据 |
| 第七章 | DEMATEL、ISM、TOPSIS | 因果分析数据、技术评估数据、层次结构数据 |
| 第八章 | 三角验证综合分析 | 综合结论数据、发展路径数据 |

### 3.2 第四章：SEM结构方程模型

**复制以下内容到TRAE**：
```
我有问卷数据中的量表数据：Q9_TTF、Q10_SI、Q11_PV、Q12_RD

请帮我进行SEM结构方程模型分析：

1. 环境准备：
   - 导入semopy库
   - 导入pandas库
   - 导入numpy库
   
2. 加载数据：
   - 读取问卷数据
   - 提取量表变量
   
3. 定义SEM模型：
   # 测量模型
   TTF =~ Q9_TTF1 + Q9_TTF2 + Q9_TTF3 + Q9_TTF4
   SI =~ Q10_SI1 + Q10_SI2 + Q10_SI3 + Q10_SI4
   PV =~ Q11_PV1 + Q11_PV2 + Q11_PV3 + Q11_PV4
   RD =~ Q12_RD1 + Q12_RD2 + Q12_RD3 + Q12_RD4 + Q12_RD5 + Q12_RD6 + Q12_RD7 + Q12_RD8
   
   # 结构模型
   PV ~ TTF + SI
   BI ~ PV + RD
   
   # 调节效应
   PV ~ TTF:SI
   
4. 模型估计：
   - 使用semopy.Model()创建模型
   - 调用fit()方法估计参数
   
5. 模型检验：
   - 计算模型拟合指标（CFI、TLI、RMSEA、SRMR）
   - 检验路径系数显著性
   
6. 结果输出：
   - 输出路径系数表（Excel格式，给制表组）
   - 输出模型拟合报告（Markdown格式，给文字组）
   - 输出路径图数据（JSON格式，给绘图组）
   - 保存结果到：E:\B正大杯\results\chapter4\
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 3.3 第五章：时间序列分析（三层递进式）

**复制以下内容到TRAE**：
```
我有技术发展时间线数据：E:\B正大杯\dataexample\tech_timeline.csv
我有政策发展时间线数据：E:\B正大杯\dataexample\policy_timeline.csv

请帮我进行第五章三层递进式分析：

【第一层：技术演进分析】
1. 技术发展阶段划分
2. 技术领域分布演变
3. 关键技术突破节点
4. 技术融合趋势

【第二层：业务需求演进分析】
1. 政策驱动业务需求
2. 技术创造业务需求
3. 业务场景演变
4. 行业差异化需求

【第三层：用户需求演进分析】
1. 用户痛点演变
2. 用户期望升级
3. 人才需求变化
4. 使用意愿驱动因素演变

【三层协同分析】
1. 技术→业务需求→用户需求传导路径
2. 协同演进时间线

结果输出：
- 技术演进数据（JSON格式，给绘图组）
- 政策演进数据（JSON格式，给绘图组）
- 协同演进数据（JSON格式，给绘图组）
- 分析报告（Markdown格式，给文字组）
- 保存结果到：E:\B正大杯\results\chapter5\
```

### 3.4 第六章：BERT文本分析

**复制以下内容到TRAE**：
```
我有问卷数据中的开放题字段：Q19_pain_points 和 Q20_suggestions

请帮我进行BERT文本分析：

1. 文本预处理：
   - 中文分词（使用jieba库）
   - 去除停用词
   - 文本清洗
   
2. BERT嵌入 + KMeans主题建模：
   - 使用中文预训练模型生成文本嵌入
   - KMeans聚类确定主题
   - 提取各主题关键词
   
3. BERT情感分析：
   - 对每条文本进行情感分类
   - 计算情感得分
   
4. 结果输出：
   - 痛点主题数据（JSON格式，给绘图组）
   - 需求主题数据（JSON格式，给绘图组）
   - 情感分析数据（JSON格式，给绘图组）
   - 主题关键词表（Excel格式，给制表组）
   - 分析报告（Markdown格式，给文字组）
   - 保存结果到：E:\B正大杯\results\chapter6\
```

### 3.5 第七章：DEMATEL + ISM + TOPSIS

**复制以下内容到TRAE**：
```
我有问卷数据中的痛点影响因素评分数据和技术方案评估数据

请帮我进行第七章多方法融合分析：

【DEMATEL分析】
1. 构建直接影响矩阵
2. 计算综合影响矩阵
3. 计算中心度和原因度
4. 识别原因因素和结果因素

【ISM分析】
1. 确定阈值构建可达矩阵
2. 计算可达集和先行集
3. 层次划分
4. 生成递阶层次结构

【TOPSIS分析】
1. 构建决策矩阵
2. 规范化决策矩阵
3. 加权规范化矩阵
4. 计算相对贴近度
5. 方案排序

结果输出：
- 因果分析数据（JSON格式，给绘图组）
- 层次结构数据（JSON格式，给绘图组）
- 技术评估数据（JSON格式，给绘图组）
- 各类表格（Excel格式，给制表组）
- 分析报告（Markdown格式，给文字组）
- 保存结果到：E:\B正大杯\results\chapter7\
```

### 3.6 第八章：三角验证综合分析

**复制以下内容到TRAE**：
```
我有前面所有章节的分析结果

请帮我进行第八章三角验证综合分析：

1. 数据三角验证：
   - 问卷数据 + 访谈数据 + 案例数据交叉验证
   
2. 方法三角验证：
   - 定量分析 + 定性分析 + 案例分析交叉验证
   
3. 结论综合：
   - 研究结论汇总
   - 发展路径建议
   - 政策建议
   
结果输出：
- 综合结论数据（JSON格式，给绘图组）
- 发展路径数据（JSON格式，给绘图组）
- 结论汇总表（Excel格式，给制表组）
- 综合报告（Markdown格式，给文字组）
- 保存结果到：E:\B正大杯\results\chapter8\
```

---

## 第四部分：调研框架优化（Day 3-4）

### 4.1 金融细分行业分析框架

| 细分行业 | 分析重点 | 数据字段 |
|----------|----------|----------|
| 银行业 | 合规风险、系统复杂度、信创替代 | Q1_industry=银行业 |
| 证券业 | 投研效率、行情实时性、合规报表 | Q1_industry=证券业 |
| 保险业 | 核保效率、理赔处理、客户服务 | Q1_industry=保险业 |
| 基金业 | 投研分析、数据治理、风险控制 | Q1_industry=基金业 |
| 支付业 | 交易监控、风控合规、客户服务 | Q1_industry=支付业 |

### 4.2 命题契合度强化

确保所有分析回归金融经济领域：
- 多行业对比分析 → 金融业差异化路径
- 竞品对比分析 → 金融领域选型建议
- 国际经验借鉴 → 中国金融业差异化路径
- 区域对比分析 → 金融RPA应用区域差异

### 4.3 第五章三层递进式分析

```
技术演进 ──────▶ 业务需求 ──────▶ 用户需求
    │               │               │
    │   技术创造需求  │   需求传导    │
    │               │               │
    └───────────────┴───────────────┘
                    │
                    ▼
           协同演进时间线
                    │
                    ▼
    金融经济领域Agentic RPA发展路径
```

---

## 第五部分：环境搭建

### 5.1 Python环境配置

**已有环境**：
- 环境名称：benjamin
- Python版本：3.12.12
- 完整路径：E:\anaconda\envs\benjamin\python.exe

**激活环境**：
```bash
conda activate benjamin
```

### 5.2 核心依赖库

| 类别 | 库名 | 用途 |
|------|------|------|
| **数据处理** | pandas, numpy | 数据读写、处理 |
| **统计分析** | scipy, statsmodels, scikit-learn | 统计建模 |
| **SEM建模** | semopy | 结构方程模型 |
| **文本分析** | transformers, sentence-transformers, jieba | BERT模型、中文分词 |
| **可视化** | pyecharts | ECharts图表（推荐） |
| **多准则决策** | pyDecision | AHP、TOPSIS、DEMATEL |
| **网络分析** | networkx | 社会网络分析 |

### 5.3 安装命令

```
请帮我检查并安装以下Python库（如果未安装）：
pandas, numpy, scipy, statsmodels, scikit-learn, semopy, 
transformers, sentence-transformers, jieba, pyecharts, networkx, openpyxl

使用清华镜像源加速安装：
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple 库名
```

---

## 第六部分：常见问题与解决方案

### 6.1 安装问题

| 问题 | 解决方案 |
|------|----------|
| pip安装超时 | 使用国内镜像：`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple 库名` |
| bertopic安装失败 | 先安装依赖：`pip install hdbscan umap-learn` |
| sentence-transformers下载模型慢 | 设置镜像：`set HF_ENDPOINT=https://hf-mirror.com` |

### 6.2 数据问题

| 问题 | 解决方案 |
|------|----------|
| CSV文件读取乱码 | 使用`encoding='utf-8'`或`encoding='gbk'` |
| 缺失值过多 | 删除缺失率>30%的样本或变量 |
| 数据类型错误 | 使用`pd.to_numeric()`转换数值类型 |

### 6.3 分析问题

| 问题 | 解决方案 |
|------|----------|
| 样本量不足（SEM） | 改用PLS-SEM，或简化模型减少参数 |
| 模型不收敛 | 检查数据质量，尝试不同的初始值 |
| 结果不合理 | 检查数据输入是否正确，检查方法假设是否满足 |

---

## 第七部分：输出物清单

| 输出物 | 文件名 | 用途 | 交付时间 |
|--------|--------|------|----------|
| 第二章图表 | chapter2_*.html | 第二章可视化 | Day 1 |
| 第三章图表 | chapter3_*.html | 第三章可视化 | Day 2 |
| 第四章SEM数据 | chapter4_*.json/xlsx/md | 第四章分析 | Day 4 |
| 第五章时间序列数据 | chapter5_*.json/xlsx/md | 第五章分析 | Day 5 |
| 第六章文本分析数据 | chapter6_*.json/xlsx/md | 第六章分析 | Day 6 |
| 第七章因果分析数据 | chapter7_*.json/xlsx/md | 第七章分析 | Day 7 |
| 第八章综合分析数据 | chapter8_*.json/xlsx/md | 第八章分析 | Day 7 |

---

*文档版本：v3.0*
*创建日期：2026-02-16*
*更新日期：2026-02-21*
*适用对象：数据分析负责人（陶婉玉）*
*主要更新：明确所有章节可视化数据输出职责、更新任务清单*
