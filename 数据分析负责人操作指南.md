# 数据分析负责人操作指南

## 写给陶婉玉的话

你好！作为数据分析负责人，你将负责所有数据分析任务。本指南将帮助你从零开始完成所有分析工作。

**重要提示**：
1. 本指南中的每个步骤都可以直接复制到TRAE中执行
2. 遇到任何问题，都可以直接问TRAE
3. 不需要担心没有经验，TRAE会一步步指导你

---

## 第一部分：环境搭建

### 1.1 安装Anaconda

**步骤1**：下载Anaconda
- 访问：https://www.anaconda.com/download
- 下载Windows版本的Anaconda
- 双击安装包，按照提示安装

**步骤2**：验证安装
- 打开"Anaconda Prompt"
- 输入：`python --version`
- 应显示：Python 3.11.x 或类似版本

### 1.2 创建项目环境

**复制以下内容到TRAE，让TRAE帮你执行**：

```
请帮我创建一个名为"rpa_analysis"的Python环境，并安装以下库：
1. pandas（数据处理）
2. numpy（数值计算）
3. matplotlib（绘图）
4. seaborn（统计绘图）
5. scipy（统计计算）
6. scikit-learn（机器学习）
7. bertopic（主题建模）
8. sentence-transformers（文本嵌入）
9. jieba（中文分词）
10. snownlp（中文情感分析）
11. networkx（网络分析）
12. semopy（结构方程模型）
13. openpyxl（Excel读写）

请在E:\B正大杯目录下创建环境。
```

### 1.3 安装时间预估

| 库名 | 安装时间 | 说明 |
|------|----------|------|
| pandas, numpy | 1-2分钟 | 基础库 |
| matplotlib, seaborn | 1-2分钟 | 绘图库 |
| scipy, scikit-learn | 2-3分钟 | 统计/机器学习 |
| bertopic | 5-10分钟 | 较大，需下载模型 |
| sentence-transformers | 10-15分钟 | 较大，需下载模型 |
| jieba, snownlp | 1分钟 | 中文处理 |
| networkx | 1分钟 | 网络分析 |
| semopy | 1-2分钟 | SEM建模 |
| **总计** | **20-30分钟** | - |

---

## 第二部分：数据预处理

### 2.1 问卷数据预处理

**当问卷回收后，复制以下内容到TRAE**：

```
我有一份问卷数据文件：E:\B正大杯\问卷数据.xlsx

请帮我完成以下数据预处理任务：

1. 读取Excel文件
2. 检查数据基本信息：
   - 样本量
   - 变量数量
   - 缺失值情况
   - 数据类型
3. 数据清洗：
   - 删除填写时间过短的样本（<60秒）
   - 删除所有题项答案相同的样本
   - 处理缺失值（删除缺失率>30%的样本）
4. 数据转换：
   - 将Likert量表数据转换为数值类型
   - 将分类变量转换为类别类型
5. 输出清洗后的数据到：E:\B正大杯\问卷数据_清洗后.xlsx

请逐步执行，并在每一步告诉我结果。
```

### 2.2 文本数据预处理

**当有痛点描述文本后，复制以下内容到TRAE**：

```
我有一份痛点描述文本文件：E:\B正大杯\痛点描述.txt

请帮我完成以下文本预处理任务：

1. 读取文本文件（每行一条痛点描述）
2. 中文分词（使用jieba库）：
   - 加载停用词表
   - 进行分词
   - 去除停用词
3. 文本清洗：
   - 去除标点符号
   - 去除数字
   - 去除单字词
4. 输出预处理后的文本到：E:\B正大杯\痛点描述_预处理后.txt

请逐步执行，并在每一步告诉我结果。
```

---

## 第三部分：RQ1痛点识别分析

### 3.1 BERTopic主题建模

**复制以下内容到TRAE**：

```
我有预处理后的痛点描述文本：E:\B正大杯\痛点描述_预处理后.txt

请帮我进行BERTopic主题建模分析：

1. 环境准备：
   - 导入bertopic库
   - 导入sentence_transformers库
   
2. 加载数据：
   - 读取预处理后的文本文件
   
3. 构建BERTopic模型：
   - 使用中文预训练模型：paraphrase-multilingual-MiniLM-L12-v2
   - 设置language="chinese"
   - 设置nr_topics="auto"（自动合并相似主题）
   
4. 训练模型：
   - 调用fit_transform方法
   
5. 结果输出：
   - 输出主题概览（topic_model.get_topic_info()）
   - 输出每个主题的代表词
   - 生成主题可视化图（topic_model.visualize_topics()）
   - 保存结果到：E:\B正大杯\主题建模结果.xlsx
   
6. 生成主题分布图：
   - 每个主题的文档数量柱状图
   - 主题-词汇分布热力图
   
请逐步执行，并在每一步告诉我结果。如果遇到错误，请告诉我如何解决。
```

### 3.2 情感分析

**复制以下内容到TRAE**：

```
我有预处理后的痛点描述文本：E:\B正大杯\痛点描述_预处理后.txt

请帮我进行情感分析：

1. 环境准备：
   - 导入snownlp库
   
2. 加载数据：
   - 读取预处理后的文本文件
   
3. 情感分析：
   - 对每条文本计算情感得分（0-1分）
   - 分类：>0.6为正面，0.4-0.6为中性，<0.4为负面
   
4. 结果输出：
   - 输出情感分布统计
   - 生成情感分布饼图
   - 保存结果到：E:\B正大杯\情感分析结果.xlsx
   
请逐步执行，并在每一步告诉我结果。
```

---

## 第四部分：RQ2因果分析

### 4.1 DEMATEL分析

**复制以下内容到TRAE**：

```
我有专家评分矩阵数据：E:\B正大杯\专家评分矩阵.xlsx

请帮我进行DEMATEL分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   - 导入matplotlib库
   
2. 加载数据：
   - 读取专家评分矩阵（10×10矩阵，行和列都是痛点因素）
   
3. DEMATEL计算步骤：
   步骤1：构建直接影响矩阵Z
   步骤2：计算规范化矩阵X = Z / max(sum(Z, axis=1))
   步骤3：计算综合影响矩阵T = X × (I - X)^(-1)
   步骤4：计算影响度R = sum(T, axis=1)（行和）
   步骤5：计算被影响度C = sum(T, axis=0)（列和）
   步骤6：计算中心度D = R + C
   步骤7：计算原因度P = R - C
   
4. 结果输出：
   - 输出各因素的中心度和原因度
   - 生成因果四象限图（横轴为中心度，纵轴为原因度）
   - 识别原因因素（P>0）和结果因素（P<0）
   - 保存结果到：E:\B正大杯\DEMATEL结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 4.2 ISM分析

**复制以下内容到TRAE**：

```
我有DEMATEL的综合影响矩阵：E:\B正大杯\DEMATEL结果.xlsx

请帮我进行ISM分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 加载数据：
   - 读取综合影响矩阵T
   
3. ISM计算步骤：
   步骤1：确定阈值θ（建议使用0.1或矩阵均值）
   步骤2：构建可达矩阵M（T>=θ的位置为1，否则为0）
   步骤3：计算可达集R(Si)（第i行值为1的列索引）
   步骤4：计算先行集A(Si)（第i列值为1的行索引）
   步骤5：层次划分：
          - 第一层：R(Si) ∩ A(Si) == R(Si) 的因素
          - 移除第一层因素，继续划分下一层
          - 重复直到所有因素划分完毕
   
4. 结果输出：
   - 输出层次划分结果
   - 生成递阶层次结构图
   - 保存结果到：E:\B正大杯\ISM结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 4.3 SEM结构方程模型

**复制以下内容到TRAE**：

```
我有问卷数据：E:\B正大杯\问卷数据_清洗后.xlsx

请帮我进行SEM结构方程模型分析：

1. 环境准备：
   - 导入semopy库
   - 导入pandas库
   - 导入numpy库
   
2. 加载数据：
   - 读取问卷数据
   
3. 定义SEM模型：
   - 定义潜变量（技术成熟度、政策环境、用户需求、业务需求、技术采纳）
   - 定义测量模型（每个潜变量对应3个观测变量）
   - 定义结构模型（潜变量间的路径关系）
   
4. 模型估计：
   - 使用semopy.Model()创建模型
   - 调用fit()方法估计参数
   
5. 模型检验：
   - 计算模型拟合指标（CFI、TLI、RMSEA、SRMR）
   - 检验路径系数显著性
   
6. 结果输出：
   - 输出路径系数表
   - 输出模型拟合报告
   - 生成路径图
   - 保存结果到：E:\B正大杯\SEM结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。如果样本量不足，请告诉我如何改用PLS-SEM。
```

---

## 第五部分：RQ3决策支持分析

### 5.1 模糊AHP分析

**复制以下内容到TRAE**：

```
我有技术方案两两比较数据：E:\B正大杯\技术方案比较.xlsx

请帮我进行模糊AHP分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 加载数据：
   - 读取两两比较矩阵（三角模糊数形式：(l,m,u)）
   
3. 模糊AHP计算步骤：
   步骤1：构建模糊判断矩阵
   步骤2：计算每行的模糊几何平均值
   步骤3：计算模糊权重
   步骤4：去模糊化（使用重心法：w = (l+m+u)/3）
   步骤5：归一化权重
   步骤6：一致性检验（使用Crisp矩阵计算CR）
   
4. 结果输出：
   - 输出各技术方案的权重
   - 输出权重排序
   - 生成权重柱状图
   - 保存结果到：E:\B正大杯\模糊AHP结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 5.2 TOPSIS分析

**复制以下内容到TRAE**：

```
我有技术方案评估数据：E:\B正大杯\技术方案评估.xlsx
我有权重数据：E:\B正大杯\模糊AHP结果.xlsx

请帮我进行TOPSIS分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   
2. 加载数据：
   - 读取技术方案评估矩阵
   - 读取权重向量
   
3. TOPSIS计算步骤：
   步骤1：构建决策矩阵D
   步骤2：规范化决策矩阵（向量归一化）
   步骤3：加权规范化矩阵V = W × D_normalized
   步骤4：确定正理想解A+（各列最大值）和负理想解A-（各列最小值）
   步骤5：计算各方案到正理想解的距离D+
   步骤6：计算各方案到负理想解的距离D-
   步骤7：计算相对贴近度C = D- / (D+ + D-)
   
4. 结果输出：
   - 输出各方案的相对贴近度
   - 输出方案排序
   - 生成排序柱状图
   - 保存结果到：E:\B正大杯\TOPSIS结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

### 5.3 敏感性分析

**复制以下内容到TRAE**：

```
我有TOPSIS结果：E:\B正大杯\TOPSIS结果.xlsx
我有原始评估数据：E:\B正大杯\技术方案评估.xlsx

请帮我进行敏感性分析：

1. 环境准备：
   - 导入numpy库
   - 导入pandas库
   - 导入matplotlib库
   
2. 敏感性分析方法：
   方法1：权重敏感性分析
   - 将每个权重增加/减少10%、20%、30%
   - 观察方案排序的变化
   - 绘制敏感性曲线
   
   方法2：蒙特卡洛模拟
   - 在权重上添加随机扰动（±10%）
   - 重复TOPSIS计算1000次
   - 统计各方案排序的分布
   
3. 结果输出：
   - 输出敏感性分析报告
   - 生成敏感性曲线图
   - 保存结果到：E:\B正大杯\敏感性分析结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。
```

---

## 第六部分：RQ4趋势预测分析

### 6.1 技术路线图绘制

**复制以下内容到TRAE**：

```
我有技术发展时间线数据：E:\B正大杯\技术时间线.xlsx

请帮我绘制技术路线图：

1. 环境准备：
   - 导入matplotlib库
   - 导入pandas库
   
2. 加载数据：
   - 读取技术时间线数据（时间节点、事件名称、事件类型、技术领域）
   
3. 绘制技术路线图：
   - 横轴：时间（2015-2025）
   - 纵轴：技术领域（RPA核心、AI融合、应用场景）
   - 标注关键事件节点
   - 区分事件类型（产品发布、技术突破、并购、融资）
   
4. 结果输出：
   - 生成技术路线图
   - 保存图片到：E:\B正大杯\技术路线图.png
   
请逐步执行，并在每一步告诉我结果。
```

### 6.2 时间序列预测（若数据充足）

**复制以下内容到TRAE**：

```
我有市场规模时间序列数据：E:\B正大杯\市场规模数据.xlsx

请帮我进行时间序列预测：

1. 环境准备：
   - 导入pandas库
   - 导入statsmodels库
   
2. 加载数据：
   - 读取市场规模数据（年份、市场规模）
   
3. 时间序列分析：
   步骤1：检验平稳性（ADF检验）
   步骤2：若不平稳，进行差分处理
   步骤3：确定ARIMA模型参数（p,d,q）
   步骤4：拟合ARIMA模型
   步骤5：预测未来3-5年市场规模
   
4. 结果输出：
   - 输出预测结果
   - 生成预测曲线图（含置信区间）
   - 保存结果到：E:\B正大杯\趋势预测结果.xlsx
   
请逐步执行，并在每一步告诉我结果和解释。如果数据点不足，请告诉我如何改用灰色预测模型GM(1,1)。
```

---

## 第七部分：常见问题与解决方案

### 7.1 安装问题

| 问题 | 解决方案 |
|------|----------|
| pip安装超时 | 使用国内镜像：`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple 库名` |
| bertopic安装失败 | 先安装依赖：`pip install hdbscan umap-learn` |
| sentence-transformers下载模型慢 | 设置镜像：`export HF_ENDPOINT=https://hf-mirror.com` |

### 7.2 数据问题

| 问题 | 解决方案 |
|------|----------|
| Excel文件读取失败 | 确保文件未被其他程序打开，或另存为xlsx格式 |
| 中文乱码 | 使用`encoding='utf-8'`或`encoding='gbk'` |
| 缺失值过多 | 删除缺失率>30%的样本或变量 |

### 7.3 分析问题

| 问题 | 解决方案 |
|------|----------|
| 样本量不足（SEM） | 改用PLS-SEM，或简化模型减少参数 |
| 模型不收敛 | 检查数据质量，尝试不同的初始值 |
| 结果不合理 | 检查数据输入是否正确，检查方法假设是否满足 |

---

## 第八部分：与TRAE交互的提示词模板

### 模板1：遇到错误时

```
我在执行以下代码时遇到了错误：

[粘贴你的代码]

错误信息是：
[粘贴错误信息]

请告诉我：
1. 错误的原因是什么？
2. 如何修复这个错误？
3. 修复后的完整代码是什么？
```

### 模板2：需要解释结果时

```
我得到了以下分析结果：

[粘贴你的结果]

请帮我解释：
1. 这个结果说明了什么？
2. 如何在报告中描述这个结果？
3. 这个结果有什么局限性？
```

### 模板3：需要生成报告内容时

```
我有以下分析结果：

[粘贴你的结果]

请帮我撰写报告中的分析结果部分：
1. 使用学术语言
2. 包含数据表格和图表描述
3. 包含结果解释和讨论
4. 字数约500-800字
```

---

## 第九部分：工作流程图

```
Week 3-4: RQ1痛点识别
├── Day 1-2: 文本预处理
├── Day 3-5: BERTopic主题建模
├── Day 5-7: 情感分析
└── Day 7: 汇总痛点清单

Week 4-5: RQ2因果分析
├── Day 1-3: DEMATEL计算
├── Day 3-5: ISM分层
├── Day 5-7: SEM建模
└── Day 7: 因果路径验证

Week 5-6: RQ3决策支持
├── Day 1-3: 模糊AHP计算
├── Day 3-5: TOPSIS排序
├── Day 5-7: 敏感性分析
└── Day 7: 决策支持报告

Week 6: RQ4趋势预测
├── Day 1-3: 技术路线图
├── Day 3-5: 时间序列预测
└── Day 5-7: 情景分析
```

---

## 第十部分：输出物清单

| 输出物 | 文件名 | 用途 |
|--------|--------|------|
| 清洗后问卷数据 | 问卷数据_清洗后.xlsx | 所有分析的数据基础 |
| 主题建模结果 | 主题建模结果.xlsx | RQ1痛点分类 |
| 情感分析结果 | 情感分析结果.xlsx | RQ1态度分析 |
| DEMATEL结果 | DEMATEL结果.xlsx | RQ2因果分析 |
| ISM结果 | ISM结果.xlsx | RQ2层次结构 |
| SEM结果 | SEM结果.xlsx | RQ2路径分析 |
| 模糊AHP结果 | 模糊AHP结果.xlsx | RQ3权重计算 |
| TOPSIS结果 | TOPSIS结果.xlsx | RQ3方案排序 |
| 敏感性分析结果 | 敏感性分析结果.xlsx | RQ3稳健性检验 |
| 技术路线图 | 技术路线图.png | RQ4趋势展示 |
| 趋势预测结果 | 趋势预测结果.xlsx | RQ4预测分析 |

---

*文档版本：v1.0*
*创建日期：2026-02-16*
*适用对象：数据分析负责人（陶婉玉）*
